<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">

    <title>Marti - Markdown Article Editor</title>
    
    <link rel="stylesheet" href="css/marti.css">
    
    <script src="libraries/marked.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Marti Markdown Articles Generator</h1>

        <div class="mode-buttons">
            <button id="side-by-side" title="Lado a lado">📃</button>
            <button id="vertical" title="Vertical">↕️</button>
            <button id="tabs" title="Abas">🗂️</button>
        </div>

        <div class="metadata">
            <input type="text" id="fileName" placeholder="Nome do arquivo (sem extensão)">
            <input type="text" id="pageTitle" placeholder="Título da página">
            <input type="text" id="pageDescription" placeholder="Descrição da página">
            <input type="text" id="metaTags" placeholder="Meta tags (separadas por vírgula)">
            <button id="generateTags">🏷️ Gerar Tags</button>
        </div>

        <hr>

        <div class="toolbar">
            <button onclick="insertMarkdown('**', '**')">B</button>
            <button onclick="insertMarkdown('*', '*')">I</button>
            <button onclick="insertMarkdown('`', '`')">Code</button>
            <button onclick="insertMarkdown('![](', ')')">Img</button>
            <button onclick="insertMarkdown('[', '](url)')">Link</button>
            <button onclick="insertTable()">Tabela</button>
            <span id="saveStatus">💾 Salvo</span>
        </div>

        <div id="editorPreviewWrapper" class="side-by-side">
            <textarea id="markdownInput" placeholder="Escreva seu artigo em Markdown..."></textarea>
            <div id="preview" class="preview"></div>
        </div>

        <div class="tabs-wrapper" style="display: none;">
            <div class="tabs">
                <button id="tabEditor">Editor</button>
                <button id="tabPreview">Preview</button>
            </div>
            <div id="tabEditorContent">
                <textarea id="markdownInputTab" placeholder="Escreva seu artigo em Markdown..."></textarea>
            </div>
            <div id="tabPreviewContent" class="preview"></div>
        </div>

        <button id="downloadBtn">📥 Baixar como HTML</button>
    </div>

    <script>
        const mdInput = document.getElementById('markdownInput');
        const preview = document.getElementById('preview');
        const saveStatus = document.getElementById('saveStatus');
        const markdownInputTab = document.getElementById('markdownInputTab');
        const tabPreviewContent = document.getElementById('tabPreviewContent');

        // Auto-save
        function autoSave() {
            localStorage.setItem('martiContent', mdInput.value);
            localStorage.setItem('martiTitle', document.getElementById('pageTitle').value);
            localStorage.setItem('martiDesc', document.getElementById('pageDescription').value);
            localStorage.setItem('martiFileName', document.getElementById('fileName').value);
            localStorage.setItem('martiTags', document.getElementById('metaTags').value);
            saveStatus.textContent = '💾 Salvo';
        }

        function loadSaved() {
            if(localStorage.getItem('martiContent')) mdInput.value = localStorage.getItem('martiContent');
            if(localStorage.getItem('martiTitle')) document.getElementById('pageTitle').value = localStorage.getItem('martiTitle');
            if(localStorage.getItem('martiDesc')) document.getElementById('pageDescription').value = localStorage.getItem('martiDesc');
            if(localStorage.getItem('martiFileName')) document.getElementById('fileName').value = localStorage.getItem('martiFileName');
            if(localStorage.getItem('martiTags')) document.getElementById('metaTags').value = localStorage.getItem('martiTags');
            renderMarkdown();
        }

        mdInput.addEventListener('input', () => {
            renderMarkdown();
            saveStatus.textContent = '⏳ Salvando...';
            clearTimeout(window.autoSaveTimer);
            window.autoSaveTimer = setTimeout(autoSave, 500);
        });

        function renderMarkdown() {
            preview.innerHTML = marked.parse(mdInput.value);
            markdownInputTab.value = mdInput.value;
            tabPreviewContent.innerHTML = marked.parse(mdInput.value);
        }

        // Markdown inserções rápidas
        function insertMarkdown(open, close) {
            const input = mdInput;
            const start = input.selectionStart;
            const end = input.selectionEnd;
            const text = input.value;
            input.value = text.substring(0, start) + open + text.substring(start, end) + close + text.substring(end);
            input.focus();
            renderMarkdown();
            autoSave();
        }

        // Inserir tabela básica
        function insertTable() {
            const table = `| Coluna 1 | Coluna 2 |\n| --- | --- |\n| Valor 1 | Valor 2 |\n`;
            mdInput.value += '\n' + table;
            renderMarkdown();
            autoSave();
        }

        // Gerar Tags (simples)
        document.getElementById("generateTags").addEventListener('click', () => {
            const words = mdInput.value.match(/\b\w{4,}\b/g);
            if (!words) return;
            const freq = {};
            words.forEach(w => freq[w] = (freq[w] || 0) + 1);
            const tags = Object.entries(freq).sort((a,b) => b[1]-a[1]).slice(0, 10).map(e => e[0]).join(', ');
            document.getElementById('metaTags').value = tags;
            autoSave();
        });

        // Download HTML com template completo
        document.getElementById("downloadBtn").addEventListener('click', () => {
            const title = document.getElementById('pageTitle').value;
            const description = document.getElementById('pageDescription').value;
            const tags = document.getElementById('metaTags').value;
            const fileName = document.getElementById('fileName').value || 'artigo';
            const today = new Date().toISOString().split('T')[0];

            const articleContent = marked.parse(mdInput.value);

            const template = `
            <!DOCTYPE html>
            <html lang="pt-br">
            <head>
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta name="author" content="Renan Mayrinck">
            <meta name="description" content="${description}">
            <meta name="keywords" content="${tags}">
            <meta property="og:type" content="website"/>
            <meta property="og:title" content="${title}">
            <meta name="og:description" content="${description}">
            <meta property="og:image" content="../media/images/fundo.jpeg">
            <meta name="og:author" content="Renan Mayrinck">
            <meta name="og:url" content="">
            <meta name="twitter:card" content="summary">
            <meta name="twitter:title" content="${title}">
            <meta name="twitter:description" content="${description}">
            <meta name="twitter:image" content="https://renanmayrinck.com/media/images/fundo.jpeg">
            <meta name="twitter:url" content="">
            <meta name="twitter:author" content="Renan Mayrinck">
            <link rel="stylesheet" href="../css/main.css">
            <link rel="shortcut icon" href="../media/images/pp3.jpg" type="image/x-icon">
            <script defer data-domain="renanmayrinck.com" src="https://plausible.io/js/script.js"></script>
            <title>${title}</title>
            </head>
            <body>
            <header>
            <nav>
            <a tabindex="1" href="../index.html">Início</a>
            <a tabindex="2" href="../portfolio.html">Portfolio</a>
            <a tabindex="3" href="../cursos.html">Cursos e Mentorias</a>
            <a tabindex="4" href="../artigos.html"><strong>Artigos</strong></a>
            </nav>
            </header>
            <section class="article-hero" style="background-image: url('../media/images/blog/uwk-title.webp');">
            <h1>${title}</h1>
            <p><time datetime="${today}">${today}</time> por <span class="author">Renan Mayrinck</span></p>
            </section>
            <main class="article-bind">
            <aside><p class="title">Conteúdos</p><ul></ul></aside>
            <article>${articleContent}</article>
            </main>
            <section class="final-cta"><h5 class="cta-title">Gostou deste artigo? Compartilhe 😊</h5>
            <div class="buttons"><button class="pop" id="contact-again">Entre em contato</button></div></section>
            <section class="final-cta">
                <h5 class="cta-title">Gostou deste artigo? Compartilhe 😊</h5>
                
                <div class="buttons">
                    <button class="pop" id="share">📣 Quero compartilhar</button>
                    <button id="copy" title="Copiar Link">📋 Copiar Link</button>
                </div>
            </section>

            <section class="contents">
                <h4>Veja outros conteúdos:</h4>

                <div id="blog-wrapper">
                    <!-- CONTEÚDO SERÁ GERADO AQUI VIA RECOMMENDATIONS.JS -->
                </div>
            </section>

            <footer>
                <p class="credits">
                    @RenanMayrinckDesign • Desde 2013
                </p>

                <div class="socials">
                    <a target="_blank" title="Meu email - renannayrinck@duck.com" href="mailto:renanmayrinck@duck.com">
                        <svg fill="#0c0c0c" width="100%" height="100%" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="path1" transform="matrix(0.047619,0,0,0.047619,0,-0.00946781)"><path d="M126.4,0.199C56.8,0.199 0,57 0,126.6L0,378.199C0,447.399 56.8,504.199 126.4,504.199L378,504.199C447.6,504.199 504.4,447.401 504.4,377.801L504.4,126.6C504,57 447.2,0.199 377.6,0.199L126.4,0.199ZM137.1,115.785L367.301,115.785C395.613,115.781 419.607,137.475 422.447,165.645L252.199,254.826L81.953,165.645C84.672,138.647 106.838,117.419 133.928,115.869L137.1,115.785ZM81.68,194.359L246.266,280.574C249.979,282.52 254.421,282.52 258.135,280.574L422.719,194.359L422.719,333.197C422.721,362.418 399.612,386.877 370.438,388.531L367.301,388.615L137.1,388.615C107.879,388.617 83.42,365.508 81.766,336.334L81.68,333.197L81.68,194.359Z" style="fill-rule:nonzero;"/></g></svg>
                    </a>

                    <a target="_blank" title="Meu perfil no Instagram" href="https://www.instagram.com/renanmayrinck">
                        <svg fill="#0c0c0c" width="100%" height="100%" viewBox="0 0 800 800" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g><rect x="0" y="0" width="800" height="800" style="fill:none;fill-rule:nonzero;"/><path d="M400,0c108.68,0 122.24,0.4 164.88,2.4c42.6,2 71.6,8.68 97.12,18.6c26.4,10.16 48.64,23.92 70.88,46.12c20.339,19.995 36.078,44.184 46.12,70.88c9.88,25.48 16.6,54.52 18.6,97.12c1.88,42.64 2.4,56.2 2.4,164.88c0,108.68 -0.4,122.24 -2.4,164.88c-2,42.6 -8.72,71.6 -18.6,97.12c-10.013,26.71 -25.756,50.905 -46.12,70.88c-20.001,20.332 -44.189,36.07 -70.88,46.12c-25.48,9.88 -54.52,16.6 -97.12,18.6c-42.64,1.88 -56.2,2.4 -164.88,2.4c-108.68,0 -122.24,-0.4 -164.88,-2.4c-42.6,-2 -71.6,-8.72 -97.12,-18.6c-26.706,-10.021 -50.9,-25.763 -70.88,-46.12c-20.343,-19.992 -36.083,-44.182 -46.12,-70.88c-9.92,-25.48 -16.6,-54.52 -18.6,-97.12c-1.88,-42.64 -2.4,-56.2 -2.4,-164.88c0,-108.68 0.4,-122.24 2.4,-164.88c2,-42.64 8.68,-71.6 18.6,-97.12c10.009,-26.712 25.753,-50.908 46.12,-70.88c19.986,-20.35 44.178,-36.091 70.88,-46.12c25.52,-9.92 54.48,-16.6 97.12,-18.6c42.64,-1.88 56.2,-2.4 164.88,-2.4Zm0,200c-109.717,0 -200,90.283 -200,200c0,109.717 90.283,200 200,200c109.717,0 200,-90.283 200,-200c0,-109.717 -90.283,-200 -200,-200Zm260,-10c0,-27.429 -22.571,-50 -50,-50c-27.429,0 -50,22.571 -50,50c0,27.429 22.571,50 50,50c27.429,0 50,-22.571 50,-50Zm-260,90c65.83,0 120,54.17 120,120c0,65.83 -54.17,120 -120,120c-65.83,0 -120,-54.17 -120,-120c0,-65.83 54.17,-120 120,-120Z" style="fill-rule:nonzero;"/></g></svg>
                    </a>

                    <a target="_blank" title="Meu perfil no LinkedIn" href="https://www.linkedin.com/in/renan-mayrinck">
                        <svg fill="#0c0c0c" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504.4 504.4" xml:space="preserve"><g><g><path d="M377.6,0.2H126.4C56.8,0.2,0,57,0,126.6v251.6c0,69.2,56.8,126,126.4,126H378c69.6,0,126.4-56.8,126.4-126.4V126.6C504,57,447.2,0.2,377.6,0.2z M168,408.2H96v-208h72V408.2z M131.6,168.2c-20.4,0-36.8-16.4-36.8-36.8c0-20.4,16.4-36.8,36.8-36.8c20.4,0,36.8,16.4,36.8,36.8C168,151.8,151.6,168.2,131.6,168.2z M408.4,408.2H408h-60V307.4c0-24.4-3.2-55.6-36.4-55.6c-34,0-39.6,26.4-39.6,54v102.4h-60v-208h56v28h1.6c8.8-16,29.2-28.4,61.2-28.4c66,0,77.6,38,77.6,94.4V408.2z"/></g></g></svg>
                    </a>

                    <a target="_blank" title="Meu canal no YouTube" href="https://www.youtube.com/renanmayrinckdesign">
                        <svg fill="#0c0c0c" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 95.333 95.333" xml:space="preserve"><g><path d="M73.104,0H22.228C9.952,0,0,9.952,0,22.228v50.877c0,12.275,9.951,22.228,22.228,22.228h50.875c12.277,0,22.229-9.952,22.229-22.228V22.228C95.332,9.952,85.381,0,73.104,0z M65.209,52.786c-9.312,4.825-18.619,9.657-27.896,14.544c-2.105,1.109-4.021,1.062-5.922-0.32c-1.429-1.037-1.947-2.482-1.938-4.21c0.024-4.964,0.008-9.929,0.007-14.894c0-4.903-0.03-9.806,0.008-14.708c0.039-5.035,3.896-7.409,8.34-5.07c9.224,4.857,18.406,9.792,27.606,14.694c2.029,1.081,3.543,2.485,3.467,5.041C68.805,50.389,67.255,51.725,65.209,52.786z"/></g></svg>
                    </a>
                </div>
            </footer>

            <dialog id="contact-form">
                <button id="close">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
                </button>

                <p class="title">Obrigado pelo interesse 😊</p>

                <p class="description">
                    Fico muito feliz que você deseja conversar comigo. Seja para fazer um orçamento de projeto ou tirar uma dúvida, abaixo estão meus contatos e redes.
                </p>

                <div class="col">
                    <a target="_blank" href="mailto:renanmayrinck@duck.com"><button>Enviar um email</button></a>
                    <a href="https://www.instagram.com/renanmayrinck/"><button>Meu Instagram</button></a>
                    <a href="https://www.linkedin.com/in/renan-mayrinck/"><button>Meu LinkedIn</button></a>
                </div>
            </dialog>

            <script src="../js/interactions.js"></script>
            <script src="../js/recommendations.js"></script>
            </body>
            </html>`;

            const blob = new Blob([template], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${fileName}.html`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // Modos de visualização
        document.getElementById("side-by-side").addEventListener("click", () => {
            document.getElementById("editorPreviewWrapper").className = "side-by-side";
            document.querySelector(".tabs-wrapper").style.display = "none";
        });
        document.getElementById("vertical").addEventListener("click", () => {
            document.getElementById("editorPreviewWrapper").className = "vertical";
            document.querySelector(".tabs-wrapper").style.display = "none";
        });
        document.getElementById("tabs").addEventListener("click", () => {
            document.getElementById("editorPreviewWrapper").className = "hidden";
            document.querySelector(".tabs-wrapper").style.display = "block";
        });

        document.getElementById("tabEditor").addEventListener("click", () => {
            document.getElementById("tabEditorContent").style.display = "block";
            document.getElementById("tabPreviewContent").style.display = "none";
        });
        document.getElementById("tabPreview").addEventListener("click", () => {
            markdownInputTab.value = mdInput.value;
            tabPreviewContent.innerHTML = marked.parse(mdInput.value);
            document.getElementById("tabEditorContent").style.display = "none";
            document.getElementById("tabPreviewContent").style.display = "block";
        });

        markdownInputTab.addEventListener('input', () => {
            mdInput.value = markdownInputTab.value;
            renderMarkdown();
            autoSave();
        });

        // Inicializa
        loadSaved();
    </script>
</body>
</html>
